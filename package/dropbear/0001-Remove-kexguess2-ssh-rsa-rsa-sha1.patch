From 07584dc235879b52a6b8916c9a159f1bc66c1db6 Mon Sep 17 00:00:00 2001
From: Jonathan BEN-AVRAHAM <jonathan.ba@siklu.com>
Date: Mon, 20 Jun 2022 10:57:56 +0300
Subject: [PATCH] Remove kexguess2, ssh-rsa (rsa-sha1)

---
 sysoptions.h | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/sysoptions.h b/sysoptions.h
index 3107a0e..a224d35 100644
--- a/sysoptions.h
+++ b/sysoptions.h
@@ -38,9 +38,11 @@
 /* Use protocol extension to allow "first follows" to succeed more frequently.
  * This is currently Dropbear-specific but will gracefully fallback when connecting
  * to other implementations. */
+#ifdef SKIP_SIKLU
 #ifndef DROPBEAR_KEXGUESS2
 #define DROPBEAR_KEXGUESS2 1
 #endif
+#endif
 
 /* Minimum key sizes for DSS and RSA */
 #ifndef MIN_DSS_KEYLEN
@@ -143,9 +145,11 @@ If you test it please contact the Dropbear author */
  * signing operations slightly slower. */
 #define DROPBEAR_RSA_BLINDING 1
 
+#ifdef SKIP_SIKLU
 #ifndef DROPBEAR_RSA_SHA1
 #define DROPBEAR_RSA_SHA1 DROPBEAR_RSA
 #endif
+#endif
 #ifndef DROPBEAR_RSA_SHA256
 #define DROPBEAR_RSA_SHA256 DROPBEAR_RSA
 #endif
-- 
2.17.1

